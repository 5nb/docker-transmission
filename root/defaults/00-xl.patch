diff --git a/libtransmission/handshake.c b/libtransmission/handshake.c
index 8dc08d3..f6dda7a 100644
--- a/libtransmission/handshake.c
+++ b/libtransmission/handshake.c
@@ -282,6 +282,8 @@ parseHandshake (tr_handshake *    handshake,
   handshake->havePeerID = true;
   dbgmsg (handshake, "peer-id is [%*.*s]", PEER_ID_LEN, PEER_ID_LEN, peer_id);
 
+  if(client_banned(peer_id)) return HANDSHAKE_ENCRYPTION_WRONG;
+
   tor = tr_torrentFindFromHash (handshake->session, hash);
   if (!memcmp (peer_id, tr_torrentGetPeerId(tor), PEER_ID_LEN))
     {
diff --git a/libtransmission/peer-mgr.c b/libtransmission/peer-mgr.c
index 30e9036..f2e490b 100644
--- a/libtransmission/peer-mgr.c
+++ b/libtransmission/peer-mgr.c
@@ -1939,6 +1939,20 @@ createBitTorrentPeer (tr_torrent       * tor,
   tr_peerMsgsUpdateActive (msgs, TR_DOWN);
 }
 
+bool client_banned (const uint8_t * peer_id)
+{
+  bool banned = false;
+  if (peer_id == NULL) return banned;
+  banned |= !memcmp(peer_id+1, "SD", 2);
+  banned |= !memcmp(peer_id+1, "XF", 2);
+  banned |= !memcmp(peer_id+1, "QD", 2);
+  banned |= !memcmp(peer_id+1, "BN", 2);
+  banned |= !memcmp(peer_id+1, "DL", 2);
+  banned |= !memcmp(peer_id+1, "XL", 2);
+  // if (banned)
+    // tr_logAddNamedError ("Client banned.", "(Client filter)");
+  return banned;
+}
 
 /* FIXME: this is kind of a mess. */
 static bool
@@ -2016,7 +2030,7 @@ myHandshakeDoneCB (tr_handshake  * handshake,
       if (io->utp_socket)
         atom->flags |= ADDED_F_UTP_FLAGS;
 
-      if (atom->flags2 & MYFLAG_BANNED)
+      if ((atom->flags2 & MYFLAG_BANNED)|client_banned(peer_id))
         {
           tordbg (s, "banned peer %s tried to reconnect",
                   tr_atomAddrStr (atom));
diff --git a/libtransmission/peer-mgr.h b/libtransmission/peer-mgr.h
index 5ee45ae..56d1227 100644
--- a/libtransmission/peer-mgr.h
+++ b/libtransmission/peer-mgr.h
@@ -84,6 +84,8 @@ void         tr_peerMgrFree                 (tr_peerMgr          * manager);
 bool         tr_peerMgrPeerIsSeed           (const tr_torrent    * tor,
                                              const tr_address    * addr);
 
+bool	     client_banned		    (const uint8_t * peer_id);
+
 void         tr_peerMgrSetUtpSupported      (tr_torrent          * tor,
                                              const tr_address    * addr);
 
